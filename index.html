
<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
	<title>CITES pre-ban major import/export countries</title>

	<!-- D3.js -->	
    <script src="http://d3js.org/d3.v3.js"></script>

	
	<!-- jQuery -->
	<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
	<!-- Latest compiled and minified CSS -->
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap.min.css">
	<!-- Latest compiled and minified JavaScript -->
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/js/bootstrap.min.js"></script>
	
	<!-- Open Sans & CSS -->
	<link href='https://fonts.googleapis.com/css?family=Roboto' rel='stylesheet' type='text/css'>
	  <style>
		body {
		  font-family: 'Roboto', sans-serif;
		  font-size: 16px;
		  font-weight: 400;
		  color: #525252;
		  text-align: center;
		}
		
		html, body { 
			width:auto; 
			height:auto; 
		}

	  </style>
  </head>
  <body>

	
	<div id="cont" class="container-fluid text-center">
	<h2> Pre-1989 African elephant CITES ban export-import patterns </h2>
	<h3> 1980-1989 major players in African elephant trade </h3>
		<div class="row">
			<div id="chart"></div>
		</div>
	<h5> Data Source: CITES Trade Database </h5>
	</div>

	<script>
		
		var matrix10x10 = [
			[0, 322, 2202, 123, 264, 32, 334, 30, 0, 178], //CA
			[286, 80, 2407, 268, 322, 130, 412, 19, 47, 346], //GB
			[4503, 3679, 297, 1213, 3030, 823, 2829, 551, 71, 1191],//US
			[518, 806, 3071, 0, 994, 240, 803, 30, 0, 1230], //IT
			[132, 151, 1588, 71, 0, 21, 215, 9, 4, 121, 5, 222, 84, 461], //JP
			[208, 826, 2955, 319, 407, 0, 610, 0, 0, 217], //ZA
			[298, 658, 2087, 439, 625, 225, 0, 24, 0, 2318], //DE
			[18, 124, 2527, 0, 31, 0, 15, 0, 0, 9], //MX
			[270, 946, 2351, 144, 329, 0, 610, 4, 0, 478], //IN
			[227, 398, 928, 393, 253, 48, 1135, 17, 0, 15 ] //CH
		];

		var labels = ['Canada', 'United Kingdom', 'United States', 'Italy', 'Japan', 'South Africa', 'Germany', 'Mexico', 'India', 'China'];


		var width = 700;
		var height = 700;
		var svg = d3.select("#chart")
			 .append("svg")
			 .attr("width", width)
			 .attr("height", height)
			 .append("g")
			 .attr("transform","translate(" + width / 2 + "," + height / 2 + ")");
			 
		var range10 = ["#1f77b4", "#9c9ede", "#8ca252", "#98df8a", "#17becf", "#ff7f0e", "#d62728", "#d6616b", "#ce6dbd", "#7f7f7f"];
		var fill = d3.scale.ordinal()
			   .domain(d3.range(range10.length))
			   .range(range10);
		var innerRadius = Math.min(width, height) * .41;
		var outerRadius = innerRadius * 1.1;
		var chord = d3.layout.chord()
			   .padding(.05)
			   .sortSubgroups(d3.descending)
			   .matrix(matrix10x10);
 
		svg.append("g")
			   .selectAll("path")
			   .data(chord.groups)
			   .enter().append("path")
			   .style("fill", function(d) {
					return fill(d.index);
			   })
			   .style("stroke", function(d) {
					return fill(d.index);
			   })
			  .attr("d", d3.svg.arc()
				   .innerRadius(innerRadius)
				   .outerRadius(outerRadius))
			  .attr("id",function(d,i){return "group"+i;})
			  .on("mouseover", fade(.1))
			  .on("mouseout", fade(1));
			  
		function fade(opacity) {
			return function(g, i) {
				svg.selectAll("g.chord path")
					.filter(function(d) {
						return d.source.index != i && d.target.index != i;
					})
					.transition()
					.style("opacity", opacity);
			};
		}
		
		svg.selectAll("text")
			.data(chord.groups)
		  .enter().append("text")
			.attr("dx", 5)
			.attr("dy", 20)
		  .append("textPath")
			.attr("class", "label")
			.attr("xlink:href", function(d) { return "#group" + d.index; })
			.data(labels)
			.text(function(d,i) { return labels[i]; })
			.style("fill", function(d) { return d3.rgb(fill(d.index)).darker(2); });
		
		svg.append("g")
			.attr("class", "chord")
			.selectAll("path")
			.data(chord.chords)
			.enter().append("path")
			.style("fill", function(d) {
				return fill(d.target.index);
			})
			.attr("d", d3.svg.chord().radius(innerRadius))
			.style("opacity", 1);

		
	</script>
	
  </body>
</html>